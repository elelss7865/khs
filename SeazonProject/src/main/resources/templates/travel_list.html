<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container my-3">
   
    <!-- travel List -->
      <table class="table">
         <thead class="table-dark">
            <tr class="text-center">
               <th>번호</th>
               <th style="width:50%">제목</th>
                 <th>글쓴이</th>
               <th>작성일시</th>
               <th>추천수</th>
               <th>조회수</th>
            </tr>
         </thead>
         
         <tbody>
            <tr class="text-center" th:each="travel, loop : ${paging}">
                <td th:text="${paging.getTotalElements - (paging.number * paging.size) - loop.index}"></td>
               <td class="text-center">
                  <a th:href="@{|/travel/detail/${travel.id}|}" th:text="${travel.subject}"></a>
                  <span class="text-danger small ms-2"
                        th:if="${#lists.size(travel.answerList) > 0}" 
                        th:text="${#lists.size(travel.answerList)}">
                    </span>
               </td>
               <td><span th:if="${travel.author != null}" th:text="${travel.author.nickname}"></span></td>
               <td th:text="${#temporals.format(travel.createDate, 'yyyy-MM-dd HH:mm')}"></td>
               <td><span th:text="${#sets.size(travel.voter)}"></span></td> <!-- 추천수 출력 -->
               <td><span th:text="${travel.view}"></span></td> <!-- 조회수 출력 -->
            </tr>
         </tbody>
      </table>
      
      <!-- 페이징처리 시작 -->
      <div th:if="${!paging.isEmpty()}">
         <ul class="pagination justify-content-center">
         
         <!-- 첫 페이지 -->
            <li class="page-item" th:classappend="${!paging.hasPrevious} ? 'disabled'">
               <a class="page-link" href="javascript:void(0)" th:data-page="0">  
                  <span>&laquo;</span>
            </a></li>
            
            <!-- 이전 페이지 -->
            <li class="page-item" th:classappend="${!paging.hasPrevious} ? 'disabled'">
               <a class="page-link" href="javascript:void(0)" th:data-page="${paging.number-1}"> 
                  <span>이전</span>
               </a>
            </li>
            
            <li th:each="page: ${#numbers.sequence(paging.number - 2, paging.number + 2)}" 
                th:if="${page >= 0 and page < paging.totalPages}" th:classappend="${page == paging.number} ? 'active'" 
                class="page-item">
                <a th:text="${page + 1}" class="page-link" href="javascript:void(0)" th:data-page="${page}"></a>
            </li>
            
            <!-- 다음 페이지 -->
            <li class="page-item" th:classappend="${!paging.hasNext} ? 'disabled'">
               <a class="page-link" href="javascript:void(0)" th:data-page="${paging.number+1}"> 
                  <span>다음</span>
               </a>
            </li>
            
            <!-- page 끝으로 -->
            <li class="page-item" th:classappend="${!paging.hasNext} ? 'disabled'">
               <a class="page-link" href="javascript:void(0)" th:data-page="${paging.totalPages-1}"> 
                  <span>&raquo;</span>
               </a>
            </li>
            
         </ul>
      </div>
      <!-- 페이징처리 끝 -->
      
      <!-- page와 kw를 동시에 get요청 할수 있는 searchform -->
      <form th:action="@{/travel/list}" method="get" id="searchForm">
           <input type="hidden" id="kw" name="kw" th:value="${kw}">
           <input type="hidden" id="page" name="page" th:value="${paging.number}">
       </form>
       
</div>
</html>